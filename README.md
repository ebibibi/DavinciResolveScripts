# DaVinci Resolve 自動編集スクリプト

## 概要
このスクリプトは、DaVinci Resolveでの動画編集ワークフローを自動化するためのものです。
本来有償版でなければできないとされているスクリプトによる自動化を無料版で実現しています。

主に以下の機能を提供します：

1. OBS録画した最新の`.mkv`ファイルを自動検出
2. `auto-editor`を使用して無音部分をカットし、XMLファイルを生成
3. 生成されたXMLファイルをDaVinci Resolveにインポート
4. タイムラインにエンディング動画を自動追加
5. 既存のタイムラインに新しく作成したタイムラインの内容を挿入

## 前提条件

- DaVinci Resolve 17以上
- Python 3.6以上
- auto-editor（コマンドラインからアクセスできる状態）
- 以下のフォルダ構造：
  - OBS録画データが保存されているフォルダ
  - エンディング動画が保存されているフォルダ

## 使用方法

1. DaVinci Resolveを起動し、プロジェクトを開きます
2. DaVinci ResolveのスクリプトコンソールでPy3を線t泣くしたうえで`defaulteditaction.py`の内容を張りつけて実行します

## 動作の仕組み

1. **auto-editorの実行**: 
   - 指定したディレクトリ内の最新の`.mkv`ファイルを探します
   - auto-editorを使用して無音部分をカットし、Resolveで使用可能なXMLファイルを生成します

2. **XMLファイルの処理**:
   - 指定したフォルダから最新のXMLファイル（`.fcpxml`または`.xml`）を探します
   - 見つかったXMLファイルをDaVinci Resolveにインポートして新しいタイムラインを作成します

3. **エンディング動画の追加**:
   - 指定したエンディング動画をメディアプールにインポートします
   - 新しく作成したタイムラインの最後にエンディング動画を追加します

4. **タイムラインの挿入**:
   - メインタイムラインでオープニングクリップ（`01_EBI_CHAN_OP`）を探します(※動画ファイルは適宜変更してください。)
   - オープニングクリップが見つかった場合、その直後に新しいタイムラインの内容を挿入します
   - オープニングクリップが見つからない場合、タイムラインの先頭に挿入します

5. **編集ポジションの設定**:
   - 最終的に編集ポジションをタイムラインの先頭に移動します

## カスタマイズ

スクリプト内の以下のパスは環境に合わせて変更してください：

1. 作業ディレクトリ（OBS録画データの保存場所）:
   ```python
   working_dir = r'C:\Users\masah\OneDrive - hccjp (1)\Youtube動画作成場所\!OBS録画'
   ```

2. XMLフォルダの候補パス:
   ```python
   xml_folder_paths = [
       r'C:\OneDrive\OneDrive - hccjp\Youtube動画作成場所\!OBS録画',
       r'C:\Users\masah\OneDrive - hccjp (1)\Youtube動画作成場所\!OBS録画'
   ]
   ```

3. エンディング動画のパス:
   ```python
   ending_video_paths = [
       r'C:\Users\masah\OneDrive - hccjp (1)\Youtube動画作成場所\!動画素材\03_EBI_CHAN_IN.mov',
       r'C:\OneDrive\OneDrive - hccjp\Youtube動画作成場所\!動画素材\03_EBI_CHAN_IN.mov'
   ]
   ```

## 注意事項

- このスクリプトは、実行前にDaVinci Resolveでプロジェクトとタイムラインが開かれている必要があります
- スクリプトは自動的に存在するパスを選択しますが、すべてのパスが存在しない場合はエラーになります
- デバッグ情報が多く出力されますが、これは問題解決のために役立ちます
- オープニングクリップは名前に「01_EBI_CHAN_OP」を含むものを探します

## トラブルシューティング

- **「指定ディレクトリに mkv ファイルが見つかりません」エラー**: 作業ディレクトリに`.mkv`ファイルがあることを確認してください
- **「タイムラインのインポートに失敗しました」エラー**: XMLファイルの形式が正しいか確認してください
- **「エンディング動画のインポートに失敗しました」エラー**: エンディング動画のパスが正しいか確認してください
